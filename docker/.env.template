# =================================
# mIRage DFIR Platform Configuration
# =================================
# 
# This template contains all configuration options for mIRage DFIR Platform.
# Copy this file to .env and configure the values for your environment.
# 
# SECURITY WARNING: Never commit .env files to version control!
# Keep your API keys and passwords secure.
#
# Usage: cp docker/.env.template docker/.env

# =================================
# CORE SYSTEM CONFIGURATION
# =================================

# Database Configuration
POSTGRES_DB=mirage_db
POSTGRES_USER=mirage_user
POSTGRES_PASSWORD=change_this_secure_password_123!

# Redis Configuration (Caching & Sessions)
REDIS_PASSWORD=redis_secure_password_456!

# RabbitMQ Configuration (Message Queue)
RABBITMQ_USER=mirage_mq
RABBITMQ_PASSWORD=rabbitmq_secure_password_789!
RABBITMQ_MGMT_PORT=15672

# Application Security Keys
# IMPORTANT: Generate secure random keys for production!
# Use: openssl rand -base64 32
SECRET_KEY=your_super_secret_key_change_me_immediately
SECURITY_PASSWORD_SALT=your_security_salt_change_me
JWT_SECRET_KEY=your_jwt_secret_key_change_me
SESSION_TIMEOUT=3600

# =================================
# ADMIN ACCOUNT CONFIGURATION
# =================================

# Initial administrator account (created on first startup)
ADMIN_EMAIL=admin@mirage.local
INITIAL_ADMIN_PASSWORD=SecureAdminPassword123!

# =================================
# NETWORK & PORT CONFIGURATION
# =================================

# External ports for web access
HTTP_PORT=80
HTTPS_PORT=443

# Monitoring ports
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000

# Application version
VERSION=2.0.0

# =================================
# MONITORING & LOGGING
# =================================

# Grafana admin credentials
GRAFANA_ADMIN_PASSWORD=grafana_admin_password_123!

# Log levels (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Enable/disable debug mode (true/false)
DEBUG_MODE=false

# =================================
# THREAT INTELLIGENCE INTEGRATIONS
# =================================

# MISP (Malware Information Sharing Platform)
# Get API key from your MISP instance: Administration > Auth Keys
MISP_URL=https://misp.example.com
MISP_API_KEY=your_misp_api_key_here
MISP_VERIFY_SSL=true
MISP_RATE_LIMIT=60

# VirusTotal
# Get API key from: https://www.virustotal.com/gui/my-apikey
VIRUSTOTAL_API_KEY=your_virustotal_api_key_here
VIRUSTOTAL_RATE_LIMIT=4

# Any.Run Interactive Malware Sandbox
# Get API key from: https://any.run/api-documentation/
ANYRUN_API_KEY=your_anyrun_api_key_here
ANYRUN_RATE_LIMIT=10

# GreyNoise Internet Intelligence
# Get API key from: https://viz.greynoise.io/account/
GREYNOISE_API_KEY=your_greynoise_api_key_here
GREYNOISE_RATE_LIMIT=100

# Hybrid Analysis (CrowdStrike Falcon Sandbox)
# Get API key from: https://www.hybrid-analysis.com/my-account
HYBRID_ANALYSIS_API_KEY=your_hybrid_analysis_api_key_here
HYBRID_ANALYSIS_SECRET=your_hybrid_analysis_secret_here
HYBRID_ANALYSIS_RATE_LIMIT=20

# =================================
# EDR/XDR PLATFORM INTEGRATIONS
# =================================

# SentinelOne Management Console
# Get API token from: Settings > Users > API Token
SENTINELONE_BASE_URL=https://your-instance.sentinelone.net
SENTINELONE_API_TOKEN=your_sentinelone_api_token_here
SENTINELONE_ACCOUNT_ID=your_account_id_here

# CrowdStrike Falcon
# Get credentials from: Support and resources > Resources and tools > CrowdStrike API clients and keys
CROWDSTRIKE_CLIENT_ID=your_crowdstrike_client_id_here
CROWDSTRIKE_CLIENT_SECRET=your_crowdstrike_client_secret_here
CROWDSTRIKE_BASE_URL=https://api.crowdstrike.com

# Sophos Central
# Get credentials from: System Settings > API Credentials
SOPHOS_CLIENT_ID=your_sophos_client_id_here
SOPHOS_CLIENT_SECRET=your_sophos_client_secret_here
SOPHOS_BASE_URL=https://api.central.sophos.com

# =================================
# SIEM INTEGRATIONS (OPTIONAL)
# =================================

# Splunk Enterprise/Cloud
SPLUNK_HOST=splunk.example.com
SPLUNK_PORT=8089
SPLUNK_TOKEN=your_splunk_hec_token_here
SPLUNK_INDEX=mirage_logs

# IBM QRadar
QRADAR_HOST=qradar.example.com
QRADAR_PORT=443
QRADAR_TOKEN=your_qradar_sec_token_here

# Elastic Stack (ELK)
ELASTICSEARCH_HOST=elasticsearch.example.com
ELASTICSEARCH_PORT=9200
ELASTICSEARCH_USERNAME=elastic
ELASTICSEARCH_PASSWORD=your_elastic_password

# Azure Sentinel
AZURE_WORKSPACE_ID=your_azure_workspace_id
AZURE_SHARED_KEY=your_azure_shared_key
AZURE_LOG_TYPE=MirageEvents

# =================================
# NOTIFICATION INTEGRATIONS
# =================================

# Email Configuration (SMTP)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USERNAME=mirage@example.com
SMTP_PASSWORD=smtp_password_here
SMTP_USE_TLS=true
SMTP_FROM_EMAIL=mirage@example.com
SMTP_FROM_NAME=mIRage DFIR Platform

# Slack Integration
# Create app at: https://api.slack.com/apps
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_CHANNEL=#security-alerts
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/your/webhook/url

# Microsoft Teams Integration
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/your-webhook-url

# Discord Integration
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/your-webhook-url

# PagerDuty Integration
PAGERDUTY_INTEGRATION_KEY=your_pagerduty_integration_key

# =================================
# CLOUD PROVIDER INTEGRATIONS
# =================================

# AWS Configuration
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_DEFAULT_REGION=us-east-1
AWS_S3_BUCKET=mirage-evidence-bucket

# Azure Configuration
AZURE_CLIENT_ID=your_azure_client_id
AZURE_CLIENT_SECRET=your_azure_client_secret
AZURE_TENANT_ID=your_azure_tenant_id
AZURE_SUBSCRIPTION_ID=your_azure_subscription_id

# Google Cloud Platform
GCP_PROJECT_ID=your-gcp-project
GCP_KEY_FILE=/app/certs/gcp-key.json

# =================================
# ADVANCED SECURITY SETTINGS
# =================================

# SSL/TLS Configuration
SSL_CERT_PATH=/app/certs/mirage.crt
SSL_KEY_PATH=/app/certs/mirage.key
SSL_REQUIRE_CERT=false

# Authentication & Authorization
ENABLE_2FA=true
REQUIRE_STRONG_PASSWORDS=true
PASSWORD_MIN_LENGTH=12
SESSION_SECURE_COOKIES=true
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION=900

# Rate Limiting
API_RATE_LIMIT=1000
API_RATE_WINDOW=3600
AUTH_RATE_LIMIT=10
AUTH_RATE_WINDOW=300

# Data Retention
CASE_RETENTION_DAYS=2555
LOG_RETENTION_DAYS=90
BACKUP_RETENTION_DAYS=30

# =================================
# PERFORMANCE TUNING
# =================================

# Database Connection Pool
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30

# Celery Worker Configuration
CELERY_WORKERS=4
CELERY_MAX_TASKS_PER_CHILD=1000
CELERY_TASK_TIME_LIMIT=1800

# Cache Configuration
CACHE_TIMEOUT=3600
CACHE_MAX_ENTRIES=10000

# File Upload Limits
MAX_UPLOAD_SIZE=100MB
ALLOWED_EXTENSIONS=.zip,.tar,.gz,.pcap,.evtx,.log,.csv,.json,.xml

# =================================
# DEVELOPMENT & TESTING
# =================================

# Development mode settings (DO NOT USE IN PRODUCTION)
# FLASK_DEBUG=true
# ENABLE_CORS=true
# DISABLE_AUTH=false
# MOCK_INTEGRATIONS=false

# Testing database (separate from production)
# TEST_DATABASE_URL=postgresql://test_user:test_pass@localhost/test_mirage

# =================================
# EXPERIMENTAL FEATURES
# =================================

# Enable beta features (use with caution)
ENABLE_AI_ANALYSIS=false
ENABLE_AUTO_RESPONSE=false
ENABLE_THREAT_SHARING=false

# Machine Learning Models
ML_MODEL_PATH=/app/models
ENABLE_IOC_SCORING=false
ENABLE_BEHAVIORAL_ANALYSIS=false

# =================================
# COMPLIANCE & GOVERNANCE
# =================================

# Data classification
DEFAULT_CLASSIFICATION=TLP:WHITE
ENABLE_DATA_MASKING=false

# Audit settings
AUDIT_ALL_ACTIONS=true
AUDIT_RETENTION_DAYS=2555

# Privacy settings
ENABLE_GDPR_MODE=false
ANONYMIZE_USER_DATA=false

# =================================
# BACKUP & DISASTER RECOVERY
# =================================

# Automatic backup settings
ENABLE_AUTO_BACKUP=true
BACKUP_SCHEDULE=daily
BACKUP_TIME=02:00
BACKUP_LOCATION=/app/backups

# Remote backup storage
BACKUP_S3_BUCKET=mirage-backups
BACKUP_ENCRYPTION_KEY=your_backup_encryption_key

# =================================
# END OF CONFIGURATION
# =================================

# Additional notes:
# 1. Restart services after changing configuration
# 2. Use strong, unique passwords for all accounts
# 3. Regularly rotate API keys and certificates
# 4. Monitor logs for security events
# 5. Keep backups secure and test restore procedures
# 
# For more information, see: https://github.com/scllpadmin/mIRage/docs
